#!/bin/sh
################################################################################
##	Copyright (C) 2020	  Alejandro Colomar Andr√©s		      ##
##	SPDX-License-Identifier:  GPL-2.0-only				      ##
################################################################################
##
## Prepare the repo for release
##==============================
##
## - Remove the files that shouldn't go into the release
## - Update version numbers
##
################################################################################


################################################################################
##	functions							      ##
################################################################################
remove_files()
{

	rm	docker-compose-devel.yaml
}

update_version()
{
	local	version=$1

	sed "/--branch master/s/master/release-${version}/"		\
			-i ./Dockerfile
	sed "/https.alejandro-colomar.com:latest/s/latest/v${version}/"	\
			-i ./docker-compose.yaml
}


################################################################################
##	main								      ##
################################################################################
main()
{
	local	version=$1

	remove_files
	update_version	${version}
}


################################################################################
##	run								      ##
################################################################################
main	$1


################################################################################
##	end of file							      ##
################################################################################
