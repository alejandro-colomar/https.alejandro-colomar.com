#!/bin/sh -x
##	./bin/deploy_swarm.sh <swarm_name>
################################################################################
##      Copyright (C) 2020        Alejandro Colomar Andr√©s                    ##
##      SPDX-License-Identifier:  GPL-2.0-only                                ##
################################################################################


################################################################################
##	functions							      ##
################################################################################
deploy_stack()
{
	local	swarm_name="$1"

	local	path="etc/docker/swarm"
	local	fname="docker-compose.yaml"

	docker stack deploy -c ${path}/${fname} ${swarm_name}

}


################################################################################
##	main								      ##
################################################################################
main()
{
	local	swarm_name="$1"

	./bin/copy_run.sh
	deploy_stack	"${swarm_name}"
}


################################################################################
##	run								      ##
################################################################################
params=1

if [ $# -ne ${params} ]; then
	echo	"Illegal number of parameters (Requires ${params})"
	exit	64	## EX_USAGE /* command line usage error */
fi

main	$1


################################################################################
##	end of file							      ##
################################################################################
